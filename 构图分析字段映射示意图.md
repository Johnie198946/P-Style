# 构图分析字段映射示意图

## 一、问题说明

**问题**：前端显示时，是否需要保持 5 个独立卡片？还是可以合并某些字段？

---

## 二、新 Prompt 结构（5个字段）

```
module_2_composition
│
├── 1. main_structure
│   └── "画面主结构分析" (文本)
│
├── 2. subject_weight
│   ├── description: "主体位置、占比" (文本)
│   └── layers: "前景/中景/远景" (文本)
│
├── 3. visual_guidance
│   ├── analysis: "线条走向分析" (文本)
│   └── path: "入口点 -> 停留点 -> 终点" (文本)
│
├── 4. ratios_negative_space
│   ├── entity_ratio: "60%" (字符串)
│   ├── space_ratio: "40%" (字符串)
│   └── distribution: "留白分布位置" (文本)
│
└── 5. style_class
    └── "构图风格归类" (文本)
```

---

## 三、前端显示方案对比

### 方案A：5个独立卡片（推荐）✅

```
┌─────────────────────────────────────────┐
│ 📐 画面主结构分析                        │
│ ─────────────────────────────────────── │
│ [主结构分析文本内容]                     │
│                                          │
│ 示例：                                   │
│ "采用经典的三分法构图，主体位于右侧..."  │
└─────────────────────────────────────────┘

┌─────────────────────────────────────────┐
│ 🎯 主体位置与视觉权重                    │
│ ─────────────────────────────────────── │
│ [主体位置、占比描述]                     │
│                                          │
│ 空间层次：                               │
│ [前景/中景/远景分布]                     │
│                                          │
│ 示例：                                   │
│ description: "人物位于画面右侧三分线..." │
│ layers: "前景：草地 | 中景：建筑 | 远景：天空" │
└─────────────────────────────────────────┘

┌─────────────────────────────────────────┐
│ 📈 线条与方向引导                        │
│ ─────────────────────────────────────── │
│ [线条走向分析文本]                       │
│                                          │
│ 视觉路径：                               │
│ [入口点 -> 停留点 -> 终点]               │
│                                          │
│ 示例：                                   │
│ analysis: "水平线引导视线从左到右..."    │
│ path: "左上角 -> 中心主体 -> 右下角"     │
└─────────────────────────────────────────┘

┌─────────────────────────────────────────┐
│ 📏 比例与留白                            │
│ ─────────────────────────────────────── │
│ [留白分布位置描述]                       │
│                                          │
│ 比例：实体 60% | 留白 40%                │
│                                          │
│ 示例：                                   │
│ distribution: "留白主要分布在左侧和上方" │
│ entity_ratio: "60%"                     │
│ space_ratio: "40%"                      │
└─────────────────────────────────────────┘

┌─────────────────────────────────────────┐
│ 💡 构图风格归类                          │
│ ─────────────────────────────────────── │
│ [构图风格归类文本]                       │
│                                          │
│ 示例：                                   │
│ "三分法构图，结合引导线构图"             │
└─────────────────────────────────────────┘
```

**优点**：
- ✅ 结构清晰，每个字段独立显示
- ✅ 符合新 Prompt 的结构，数据映射简单
- ✅ 信息完整，不丢失任何细节

**缺点**：
- ⚠️ 需要修改前端（从7段改为5段）

---

### 方案B：合并部分字段（3个卡片）

```
┌─────────────────────────────────────────┐
│ 📐 画面结构与主体                        │
│ ─────────────────────────────────────── │
│ 主结构分析：                             │
│ [主结构分析文本]                         │
│                                          │
│ 主体位置与视觉权重：                     │
│ [主体位置、占比描述]                     │
│                                          │
│ 空间层次：                               │
│ [前景/中景/远景分布]                     │
└─────────────────────────────────────────┘

┌─────────────────────────────────────────┐
│ 📈 视觉引导与比例                        │
│ ─────────────────────────────────────── │
│ 线条与方向引导：                         │
│ [线条走向分析文本]                       │
│ 视觉路径：入口点 -> 停留点 -> 终点       │
│                                          │
│ 比例与留白：                             │
│ [留白分布位置描述]                       │
│ 比例：实体 60% | 留白 40%                │
└─────────────────────────────────────────┘

┌─────────────────────────────────────────┐
│ 💡 构图风格归类                          │
│ ─────────────────────────────────────── │
│ [构图风格归类文本]                       │
└─────────────────────────────────────────┘
```

**优点**：
- ✅ 卡片数量更少，界面更简洁
- ✅ 相关字段合并，逻辑更清晰

**缺点**：
- ⚠️ 需要重新组织内容
- ⚠️ 可能丢失某些细节
- ⚠️ 不符合新 Prompt 的结构

---

### 方案C：保持7段结构（向后兼容）

```
将新结构的5个字段映射到现有的7段：

1. 画面主结构分析
   ← main_structure

2. 主体位置与视觉权重
   ← subject_weight.description

3. 线条与方向引导
   ← visual_guidance.analysis

4. 空间层次与分区
   ← subject_weight.layers

5. 比例与留白
   ← ratios_negative_space.distribution
   + ratios_negative_space.entity_ratio
   + ratios_negative_space.space_ratio

6. 视觉平衡与动势
   ← visual_guidance.path

7. 构图风格归类与改进建议
   ← style_class
```

**优点**：
- ✅ 无需修改前端
- ✅ 保持现有设计

**缺点**：
- ⚠️ 需要智能映射，可能丢失信息
- ⚠️ 不符合新 Prompt 的结构
- ⚠️ 某些字段需要拆分或合并

---

## 四、推荐方案

### 推荐：方案A（5个独立卡片）✅

**理由**：
1. **符合新 Prompt 结构**：数据映射简单，无需智能拆分或合并
2. **信息完整**：每个字段独立显示，不丢失任何信息
3. **前端改动可控**：只需修改 `CompositionSection.tsx`，将7段改为5段
4. **用户体验好**：结构清晰，便于理解

**实施步骤**：
1. 修改 `CompositionSection.tsx`，将 `analysisItems` 从7个改为5个
2. 每个字段对应一个卡片
3. `subject_weight` 和 `ratios_negative_space` 可以显示子字段（description + layers，或 distribution + ratios）

---

## 五、实施示例

### 5.1 前端代码修改

```tsx
// CompositionSection.tsx
const compositionItems = [
  {
    key: 'main_structure',
    title: '画面主结构分析',
    subtitle: 'Main Structure',
    icon: Grid3x3,
    content: data.main_structure,
    // ... 样式配置
  },
  {
    key: 'subject_weight',
    title: '主体位置与视觉权重',
    subtitle: 'Subject Weight',
    icon: Target,
    content: data.subject_weight?.description,
    layers: data.subject_weight?.layers,  // 子字段
    // ... 样式配置
  },
  {
    key: 'visual_guidance',
    title: '线条与方向引导',
    subtitle: 'Visual Guidance',
    icon: TrendingUp,
    content: data.visual_guidance?.analysis,
    path: data.visual_guidance?.path,  // 子字段
    // ... 样式配置
  },
  {
    key: 'ratios_negative_space',
    title: '比例与留白',
    subtitle: 'Proportion & Negative Space',
    icon: Maximize2,
    content: data.ratios_negative_space?.distribution,
    ratios: data.ratios_negative_space,  // 子字段（包含 entity_ratio 和 space_ratio）
    // ... 样式配置
  },
  {
    key: 'style_class',
    title: '构图风格归类',
    subtitle: 'Style Classification',
    icon: Lightbulb,
    content: data.style_class,
    // ... 样式配置
  }
];
```

### 5.2 卡片渲染（带子字段）

```tsx
{compositionItems.map((item, index) => {
  // ... 基础渲染 ...
  
  {/* 子字段显示 */}
  {item.layers && (
    <div className="mt-3 p-3 bg-white/50 rounded-lg">
      <p className="text-sm text-gray-600">
        <strong>空间层次：</strong>{item.layers}
      </p>
    </div>
  )}
  
  {item.path && (
    <div className="mt-3 p-3 bg-white/50 rounded-lg">
      <p className="text-sm text-gray-600">
        <strong>视觉路径：</strong>{item.path}
      </p>
    </div>
  )}
  
  {item.ratios && (
    <div className="mt-3 p-3 bg-white/50 rounded-lg">
      <p className="text-sm text-gray-600">
        <strong>比例：</strong>
        实体 {item.ratios.entity_ratio}，留白 {item.ratios.space_ratio}
      </p>
    </div>
  )}
})}
```

---

## 六、总结

### 6.1 方案对比

| 方案 | 卡片数量 | 前端改动 | 信息完整性 | 推荐度 |
|------|---------|---------|-----------|--------|
| **方案A：5个独立卡片** | 5 | 中等 | ✅ 完整 | ⭐⭐⭐⭐⭐ |
| **方案B：合并字段** | 3 | 中等 | ⚠️ 可能丢失 | ⭐⭐⭐ |
| **方案C：保持7段** | 7 | 小 | ⚠️ 需要映射 | ⭐⭐ |

### 6.2 最终建议

**选择方案A（5个独立卡片）**

**原因**：
1. 符合新 Prompt 结构，数据映射简单
2. 信息完整，不丢失任何细节
3. 前端改动可控，只需修改一个组件
4. 用户体验好，结构清晰

---

**请确认是否采用方案A，以便我开始实施！**

